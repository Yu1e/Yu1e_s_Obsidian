<%*
// Шаблон создаёт новую заметку, перед этим предлагая ввести её название в диалоговое окно, и сразу вставляет шапку с датой и пустыми свойствами. Название можно пропустить, тогда оно автоматически будет создано по дате и времени.

// ШАГ 1: Запрашиваем название и определяем финальный путь для файла.
const userTitle = await tp.system.prompt("Название заметки. Или просто ВВОД для ГГГГ_ММ_ДД_ЧЧММ");
let newTitle = (!userTitle || userTitle.trim() === "") ? tp.date.now("YYYY_MM_DD_HHmm") : userTitle;
const finalPath = "ВСЁ_ОСТАЛЬНОЕ/Накопитель/" + newTitle;

// ШАГ 2: "Планируем" перемещение. Templater выполнит его ПОСЛЕ того, как мы вернем контент.
await tp.file.move(finalPath);

// ШАГ 3: Вызываем нашу вторую функцию, чтобы получить текст для шапки.
const content = tp.user.yaml.generate(tp);

// ШАГ 4: Возвращаем этот текст. Templater сам создаст файл с этим контентом в запланированном месте.
return content;
%>